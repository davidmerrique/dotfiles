#!/bin/sh

sudo -v

while true; do sudo -n true; sleep 60; kill -0 "$$" || exit; done 2>/dev/null &

export DOTFILES=~/.dotfiles

git -C $DOTFILES submodule update --init
git -C $DOTFILES submodule foreach "(git checkout master; git pull)"

if [ ! -d ~/.config/base16-shell ]; then
  git clone git://github.com/chriskempson/base16-shell.git ~/.config/base16-shell
fi

if [ ! -d ~/.npm-packages ]; then
  mkdir ~/.npm-packages
fi

if [ ! -d ~/.zfunctions ]; then
  mkdir ~/.zfunctions
fi

if [ ! -d ~/.nvm ]; then
  git clone https://github.com/creationix/nvm.git ~/.nvm && cd ~/.nvm && git checkout `git describe --abbrev=0 --tags`
fi

if [ ! -d ~/.phpbrew ]; then
  curl -L -O https://github.com/phpbrew/phpbrew/raw/master/phpbrew
  chmod +x phpbrew
  sudo mv phpbrew /usr/bin/phpbrew
  phpbrew init
fi

if [ ! -d ~/zgen ]; then
  git clone git@github.com:tarjoilija/zgen.git ~/zgen
fi

if [ ! -f "$HOME/bin/composer.phar" ]; then
  curl -sS https://getcomposer.org/installer | php -- --install-dir="$HOME/bin"
fi

# Plug
curl -fLo ~/.vim/autoload/plug.vim --create-dirs https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim
