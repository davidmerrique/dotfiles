#!/bin/sh

sudo -v

while true; do sudo -n true; sleep 60; kill -0 "$$" || exit; done 2>/dev/null &

export DOTFILES=~/.dotfiles

if [ ! -e ~/.config/base16-shell ]; then
  git clone git://github.com/chriskempson/base16-shell.git ~/.config/base16-shell
fi

if [ ! -e ~/.npm-packages ]; then
  mkdir ~/.npm-packages
fi

if [ ! -e ~/.zfunctions ]; then
  mkdir ~/.zfunctions
fi

if [ ! -e "${ZDOTDIR:-$HOME}/.zprezto" ]; then
  git clone --recursive https://github.com/sorin-ionescu/prezto.git "${ZDOTDIR:-$HOME}/.zprezto"
fi

zfiles=(
  "${ZDOTDIR:-$HOME}"/.zprezto/runcoms/zlogin
  "${ZDOTDIR:-$HOME}"/.zprezto/runcoms/zpreztorc
  "${ZDOTDIR:-$HOME}"/.zprezto/runcoms/zprofile
)

for rcfile in "${zfiles[@]}"; do
  if [ ! -L "$rcfile" ]; then
    ln -s "$rcfile" "${ZDOTDIR:-$HOME}/.$(basename $rcfile)"
  fi
done

if [ ! -e ~/.nvm ]; then
  git clone https://github.com/creationix/nvm.git ~/.nvm && cd ~/.nvm && git checkout `git describe --abbrev=0 --tags`
fi

# Plug
mkdir -p ~/.vim/autoload
curl -fLo ~/.vim/autoload/plug.vim https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim
