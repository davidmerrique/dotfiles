#!/bin/sh

export DOTFILES=$HOME/.dotfiles

if [ ! -d $HOME/.zfunctions ]; then
  mkdir $HOME/.zfunctions
fi

if [ ! -d $HOME/.nvm ]; then
  git clone https://github.com/creationix/nvm.git $HOME/.nvm && cd $HOME/.nvm && git checkout `git describe --abbrev=0 --tags`
fi

# if [ ! -d $HOME/.phpbrew ]; then
#   curl -L -O https://github.com/phpbrew/phpbrew/raw/master/phpbrew
#   chmod +x phpbrew
#   sudo mkdirp /opt/phpbrew/bin
#   sudo mv phpbrew /opt/phpbrew/bin/phpbrew
#   sudo ln -s /opt/phpbrew/bin/phpbrew /usr/local/bin/phpbrew
#   phpbrew init
# fi

if [ ! -d $HOME/zgen ]; then
  git clone git@github.com:tarjoilija/zgen.git $HOME/zgen
fi

if [ ! -f $HOME/bin/composer.phar ]; then
  curl -sS https://getcomposer.org/installer | php -- --install-dir="$HOME/bin"
fi

if [ ! -e $HOME/.vim/autoload/plug.vim ]; then
  curl -fLo $HOME/.vim/autoload/plug.vim --create-dirs https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim
fi
vim -u $HOME/.vimrc.bundles +PlugInstall +PlugClean! +qa

if [ ! -e $HOME/.rbenv ]; then
  ln -s /usr/local/opt/rbenv $HOME/.rbenv
fi

if [ ! -e /usr/local/bin/gifify ]; then
  curl -o /usr/local/bin/gifify -O https://raw.githubusercontent.com/jclem/gifify/master/gifify.sh
  chmod +x /usr/local/bin/gifify
fi

if ! grep -Fxq "$(command -v zsh)" /etc/shells
then
  command -v zsh | sudo tee -a /etc/shells
  sudo chsh -s "$(command -v zsh)" "${USER}"
fi

# Install spot
if test ! $(which spot); then
  curl -L https://raw.github.com/guille/spot/master/spot.sh -o /usr/local/bin/spot && chmod +x /usr/local/bin/spot
fi
